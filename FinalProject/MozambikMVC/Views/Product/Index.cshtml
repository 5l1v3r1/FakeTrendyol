@model ReflectionIT.Mvc.Paging.PagingList<Product>
@using ReflectionIT.Mvc.Paging
@addTagHelper *,ReflectionIT.Mvc.Paging
@inject Mozambik.Data.ProductDbContext  dbContext
@using Microsoft.EntityFrameworkCore;



<input value="@User.Identity.Name" hidden id="userId" />
<div class="banner banner2">
    <div class="container">
        <h2>Top Selling <span>Gadgets</span> Flat <i>25% Discount</i></h2>
    </div>
</div>
<!-- breadcrumbs -->
<div class="breadcrumb_dress">
    <div class="container">
        <ul>
            <li><a href="index.html"><span class="glyphicon glyphicon-home" aria-hidden="true"></span> Home</a> <i>/</i></li>
            <li>@ViewBag.Markas[0].CategoryName</li>
        </ul>
    </div>
</div>
<!-- //breadcrumbs -->
<!-- mobiles -->
<div class="mobiles">
    <div class="container">
        <div class="w3ls_mobiles_grids row mb-5">
            <div class="col-md-4 w3ls_mobiles_grid_left">
                <div class="w3ls_mobiles_grid_left_grid">
                    <h3>Categories</h3>
                    <div class="w3ls_mobiles_grid_left_grid_sub">
                        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                            <div class="panel panel-default">
                                <div class="panel-heading" role="tab" id="headingOne">
                                    <h4 class="panel-title asd">
                                        <a class="pa_italic" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span><i class="glyphicon glyphicon-minus" aria-hidden="true"></i>Brendlər
                                        </a>
                                    </h4>
                                </div>
                                <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                    <div class="panel-body panel_text">
                                        <ul>
                                            @foreach (var item in ViewBag.Markas)
                                            {
                                                <li><a asp-action="Search" class="callPartialForName" asp-route-id="@item.SubMenuId" asp-route-send="@item.ID">@item.Name</a></li>
                                            }
                                        </ul>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>

                <div class="w3ls_mobiles_grid_left_grid">
                    <h3>Price</h3>
                    <div class="w3ls_mobiles_grid_left_grid_sub">
                        <div class="ecommerce_color ecommerce_size">
                            <ul>
                                <li><a asp-action="Search" class="callPartial" asp-route-id="@ViewBag.Markas[0].SubMenuId" asp-route-price="0">Below $ 100</a></li>
                                <li><a asp-action="Search" class="callPartial" asp-route-id="@ViewBag.Markas[0].SubMenuId" asp-route-price="100">$ 100-200</a></li>
                                <li><a asp-action="Search" class="callPartial" asp-route-id="@ViewBag.Markas[0].SubMenuId" asp-route-price="200">$ 200-300</a></li>
                                <li><a asp-action="Search" class="callPartial" asp-route-id="@ViewBag.Markas[0].SubMenuId" asp-route-price="300">$ 300-400</a></li>
                                <li><a asp-action="Search" class="callPartial" asp-route-id="@ViewBag.Markas[0].SubMenuId" asp-route-price="400">$ Above 400</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-8 w3ls_mobiles_grid_right " id="partialViewCaller">
                <div class="row">
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-md-6 w3ls_mobiles_grid_right_left">
                                <div class="w3ls_mobiles_grid_right_grid1">
                                    <img src="~/Teplatecss/images/48.jpg" alt=" " class="img-responsive" />
                                    <div class="w3ls_mobiles_grid_right_grid1_pos1">
                                        <h3>Attractive<span> New</span> Wrist Watches</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 w3ls_mobiles_grid_right_left">
                                <div class="w3ls_mobiles_grid_right_grid1">
                                    <img src="~/Teplatecss/images/49.jpg" alt=" " class="img-responsive" />
                                    <div class="w3ls_mobiles_grid_right_grid1_pos">
                                        <h3>Best Prices On<span> Laptop</span>Upto 50% Off</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix"> </div>

                    <div class="col-md-12">
                        <div class="row">
                            @foreach (var product in Model)
                            {
                                <div class="w3ls_mobiles_grid_right_grid3 col-md-4">
                                    <div class="row">
                                        <div class="col-md-4 agileinfo_new_products_grid agileinfo_new_products_grid_mobiles">
                                            <div class="agile_ecommerce_tab_left mobiles_grid row">
                                                <div class="hs-wrapper hs-wrapper2">
                                                    @foreach (var picture in product.Pictures)
                                                    {
                                                        <img src="~/Images/@picture.PhotoUrl" alt=" " class="img-responsive" />
                                                    }
                                                    <div class="w3_hs_bottom w3_hs_bottom_sub1">
                                                        <ul>
                                                            <li>
                                                                <a asp-action="Details" asp-controller="Product" asp-area=null asp-route-id="@product.Id"><span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span></a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                @{string name = product.Model.Marka.Name + product.Model.Name + product.Name; }
                                                @{var price = product.Price * (100 - product.Discount) / 100;}
                                                <div class="col-12">
                                                    <div class="row">
                                                        <div class="col-12"><h5><a asp-action="Details" asp-controller="Product" asp-area=null asp-route-id="@product.Id"></a>@name</h5></div>
                                                        <div class="simpleCart_shelfItem col-12">
                                                            <div class="row">
                                                                <div class="col-12">
                                                                    @if (product.Discount > 0)
                                                                    {
                                                                        <p><span>@product.Price</span> <i class="item_price">@price</i></p>
                                                                    }
                                                                    else
                                                                    {
                                                                        <p> <i class="item_price">@price</i></p>

                                                                    }
                                                                </div>
                                                            </div>

                                                            <div class="row">
                                                                <div class="col-12" method="post">

                                                                    <input type="hidden" name="cmd" class="price" value="@product.Price" />
                                                                    <input type="hidden" name="add" class="id" value="@product.Id" />
                                                                    <input type="hidden" name="w3ls_item" class="name" value="@name" />
                                                                    <button type="submit" class="w3ls-cart clickedButton">Add to cart</button>
                                                                </div>
                                                            </div>
                                                            @if (product.CreatedDate > DateTime.Now.AddDays(-7) && product.CreatedDate < DateTime.Now)
                                                            {
                                                                <div class="mobiles_grid_pos">
                                                                    <h6>New</h6>
                                                                </div>
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>

                    <div class="clearfix"> </div>
                </div>
            </div>

            <div class="clearfix"> </div>
        </div>
        <div class=" row">
            <div class="col-md-4 w3ls_mobiles_grid_left"></div>
            <div class="col-md-8 w3ls_mobiles_grid_right  mt-2">
                <nav aria-label="List navigation example" class="text-center">
                    <vc:pager paging-list="@Model" />
                </nav>

            </div>
        </div>
    </div>
</div>

<!-- Related Products -->
<div class="w3l_related_products">
    <div class="container">
        <h3>Related Products</h3>


        @{await Html.RenderPartialAsync("ProductPartial", dbContext.Products.Include(x => x.Model).ThenInclude(x => x.Marka).ThenInclude(x => x.Category).Include(x => x.Pictures).Where(x => x.Model.Marka.Category.Id ==id )).Skip(9).Take(9).ToList());}


    </div>
</div>
<!-- //Related Products -->
<!-- newsletter -->
<div class="newsletter">
    <div class="container">
        <div class="col-md-6 w3agile_newsletter_left">
            <h3>Burada sizin reklamınız ola bilər!</h3>
        </div>

        <div class="clearfix"> </div>
    </div>
</div>
<!-- //newsletter -->

@*@section Scripts{
    <script>
        $(document).ready(() => {
            $(".callPartial").click(function (e) {
                var dataS = $(this).data("send");
                var dataId = @Model.Id;
                $.ajax({
                    url: "/Product/PartialViewCaller",
                    type: "post",
                    data: { data: dataS, id: dataId },
                    success: function (res) {
                        $("#partialViewCaller").html("");
                        $("#partialViewCaller").append(res);
                    }
                })
                e.preventDefault();
            })

            $(".click").click(function (e) {
                var dataId = @Model.Id;
                var d = $(this).data("id");
                console.log(d)
                $.ajax({
                    url: "/Product/PartialViewCaller3",
                    type: "post",
                    data: { number: d, id: dataId },
                    success: function (res) {
                        $("#partialViewCaller").html("");
                        $("#partialViewCaller").append(res);
                    }
                })
                e.preventDefault();
            })


            $(".callPartialForName").click(function () {
                var data = $(this).data("send");
                var dataId = @Model.Id;
                $.ajax({
                    url: "/Product/PartialViewCaller2",
                    type: "post",
                    data: { marka: data, id: dataId },
                    success: function (res) {
                        $("#partialViewCaller").html("");
                        $("#partialViewCaller").append(res);
                    }
                })
            })
        })
    </script>
}*@